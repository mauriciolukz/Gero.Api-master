SELECT		CAST(RAR.RINVC AS INTEGER) AS InvoiceNumber,
			LTRIM(RTRIM(RAR.ARCPO)) AS InvoiceNumberFromSmartSales,
			CAST(RAR.RCUST AS INTEGER) AS CustomerCode,
			CAST(RAR.RDATE AS INTEGER) AS InvoiceDate,
			CAST(RAR.RDDTE AS INTEGER) AS DueDate,
			RAR.RAMT AS StartingAmount,
			RAR.RREM AS Balance,
			CONVERT(BIT, F.CONTADOSS) AS IsCashInvoice 
FROM		INTRANET.DISTRIBUCION.DST_Factura AS F WITH(NOLOCK)
INNER JOIN	{schema}.RAR AS RAR
ON			RTRIM(RAR.ARCPO) = RTRIM(F.NumFactura)
AND			RAR.RCUST = F.CodigoCliente
WHERE		RAR.RCUST BETWEEN 9900000 AND 9999999
AND			RAR.ARCPO <> '' AND RAR.RREM > 1
AND			RAR.RCUST IN (
				SELECT		RCM.CCUST
				FROM		{schema}.RCM AS RCM
        		WHERE		RCM.CMID = 'CM' 
        		AND			RCM.CCUST BETWEEN 9900000 AND 9999999
        		AND			(RCM.CREF01 = '{routeCode}' OR RCM.CMUF04 = '{routeCode}'  OR RCM.CWHSE = '{routeCode}')
			)
UNION ALL
SELECT		CAST(RAR.RINVC AS INTEGER) AS InvoiceNumber,
			LTRIM(RTRIM(RAR.ARCPO)) AS InvoiceNumberFromSmartSales,
			CAST(RAR.RCUST AS INTEGER) AS CustomerCode,
			CAST(RAR.RDATE AS INTEGER) AS InvoiceDate,
			CAST(RAR.RDDTE AS INTEGER) AS DueDate,
			RAR.RAMT AS StartingAmount,
			RAR.RREM AS Balance,
			CONVERT(BIT, 0) AS IsCashInvoice 
FROM		{schema}.RAR AS RAR
WHERE		RRESN <> 'BILF1' AND RAR.RCUST BETWEEN 9900000 AND 9999999
AND			RAR.ARCPO <> '' AND RAR.RREM > 1
AND			RAR.RCUST IN (
				SELECT		RCM.CCUST
				FROM		{schema}.RCM AS RCM
        		WHERE		RCM.CMID = 'CM'
        		AND			RCM.CCUST BETWEEN 9900000 AND 9999999
        		AND			(RCM.CREF01 = '{routeCode}' OR RCM.CMUF04 = '{routeCode}' OR RCM.CWHSE = '{routeCode}')
			)
ORDER BY	InvoiceDate